<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <title id="title"></title>
    <style>
        iframe {
            width: 100%;
            height: 90vh;
        }
        #backButton {
            position: absolute;
            font-family: Arial, Helvetica, sans-serif;
            color: #333;
            text-decoration: none;
            top: 30px;
            left: 30px;
        }
        #backButton:visited {
            color: #333;
        }
        #backButton:hover {
            color: #4d4b4b;
        }
        #backButton:active,
        #backButton:focus {
            outline: none;
        }
    </style>
</head>
<body>
    <nav class="container-fluid">
        <ul>
          <li><strong>Musically Miles</strong></li>
        </ul>
        <ul>
          <li><a class="outline" id="Back" role="button" href="/">Back</a></li>
        </ul>
      </nav>
    <div id="container">
        <h1 id="header"></h1>
        <button id="savePlaylistButton">Save to Spotify</button>
        <iframe src="https://open.spotify.com/embed/playlist/{{ playlist.id }}" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
    </div>
        

    <script>
        var state = "{{ state }}";
        var titleElement = document.getElementById('title');
        var headerElement = document.getElementById('header');

        function typeWriter(text, i, fnCallback) {
            if (i < (text.length)) {
                fnCallback(text.substring(0, i+1));
                setTimeout(function() {
                    typeWriter(text, i + 1, fnCallback)
                }, 50);
            }
        }

        function startTyping() {
            typeWriter("Welcome to " + state, 0, function(text) {
                titleElement.innerHTML = text;
            });
            typeWriter("Our pick for " + state, 0, function(text) {
                headerElement.innerHTML = text;
            });
        }

        window.onload = startTyping;

        document.getElementById('savePlaylistButton').addEventListener('click', function() {
            fetch('/save_playlist', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ playlistId: "{{ playlist.id }}" })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Playlist saved:', data);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
</body>
</html>